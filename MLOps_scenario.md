# MLOps 시뮬레이션 시나리오

# MLOps 파이프라인 시뮬레이션 시나리오 안내서

이 문서에서는 저희가 시연할 MLOps 파이프라인이 어떤 시나리오로 동작하는지 누구나 쉽게 이해할 수 있도록 설명해 드립니다.

---

### 🎯 시나리오 목표: “최신 정보로 스스로를 업데이트하는 AI 모델”

저희의 목표는 AI 모델이 **주기적으로 최신 데이터를 학습하고, 그 결과를 자동으로 서비스에 반영**하는 완전 자동화 시스템을 구축하고 시연하는 것입니다.

마치 신문사가 매일 최신 뉴스를 취재해 다음 날 아침 신문을 배포하듯, 저희 시스템은 **주기적으로 최신 모델을 만들어 서비스에 자동으로 배포**합니다.

### 📜 시나리오 개요

저희는 **“만약 이 시스템을 2년간 운영했다면 어땠을까?”**를 압축해서 보여주는 **시뮬레이션**을 진행합니다. 이를 위해 2년 치의 비트코인(BTC) 가격 데이터를 미리 준비했습니다.

1.  **학습 서버 (데이터 분석팀)**
    - **매주**, 가장 **최신 한 달 치**의 데이터를 사용해 새로운 예측 모델을 학습시킵니다.
    - 학습이 완료되면, 모델을 `20250531`과 같은 **날짜 기반의 별칭(Alias)**으로 MLflow 모델 레지스트리에 등록합니다. 성능 비교는 하지 않습니다.

2.  **추론 서버 (서비스 운영팀)**
    - **매주**, MLflow에 새로 등록된 모델이 있는지 확인하고, 가장 최신 버전의 모델로 **자동으로 서비스를 교체**합니다.
    - 고객(클라이언트)으로부터 예측 요청을 받으면, 현재 서비스 중인 최신 모델을 사용해 예측 결과를 안정적으로 전달하는 역할에만 집중합니다.

3.  **MLflow & MinIO (중앙 기록 보관소 & 파일 저장 창고)**
    - **MLflow:** 모든 모델의 훈련 기록, 사용된 데이터, 성능 등을 기록하고, `20250531`과 같은 날짜 기반 별칭으로 모델의 버전을 관리하는 **‘중앙 기록 보관소’**입니다.
    - **MinIO:** 학습된 모델 파일(`.pkl`)과 같은 결과물들이 실제로 보관되는 **‘파일 저장 창고’**입니다.

---

### ⚙️ 시뮬레이션 단계별 설명

### 1단계: 최초 모델의 탄생과 배포

- **학습 서버**가 특정 과거 한 달 치의 데이터로 첫 번째 모델을 학습합니다.
- 이 모델이 `20250430`과 같은 별칭으로 MLflow에 등록되고, **추론 서버**는 이 모델을 서비스에 배포합니다.

### 2단계: 새로운 주간 모델의 등장

- 일주일의 시간이 흘렀다고 가정합니다.
- **학습 서버**는 다시 가장 **최신 한 달 치**의 데이터로 새로운 모델을 학습시키고, `20250507`이라는 새 별칭으로 MLflow에 등록합니다.

### 3단계: 서비스 모델의 자동 업데이트

- **추론 서버**는 매주 자동으로 MLflow를 확인하여, 더 최신 별칭(`20250507`)을 가진 모델이 등록된 것을 발견합니다.
- 즉시 서비스 모델을 `20250507` 모델로 교체합니다. 이 과정은 사람의 개입 없이 **완전 자동으로** 이루어집니다.

---

이러한 시뮬레이션을 통해 저희는 MLOps의 핵심 가치인 **자동화된 주기적 학습, 버전 관리 기반의 모델 배포, 그리고 안정적인 서비스 운영** 과정을 효과적으로 보여드릴 수 있습니다.

---

## 🎛️ 시스템 구성 요소 상세 분석 (다이어그램 기반)

위 시나리오가 동작하기 위해, 저희 시스템은 다음과 같은 서버(컴포넌트)들로 구성되어 있습니다. 이 모든 서버들은 **Docker Compose**라는 도구를 통해 하나의 시스템으로 묶여 함께 동작합니다.

### 1. FastAPI 서버 (추론 서버)

- **역할:** AI 서비스의 “얼굴”이자 고객 응대 창구입니다.
- **주요 임무:**
    1.  **기간 예측 요청 접수:** 클라이언트로부터 “특정 날짜 이후의 가격을 예측해줘” 라는 요청(`predict_range`)을 받습니다.
    2.  **최신 모델로 예측:** 현재 서비스하도록 설정된 최신 모델을 사용하여, 요청받은 기간 전체의 예측값을 계산하여 반환합니다.
    3.  **주기적 모델 업데이트:** 매주 자동으로 MLflow에서 가장 최신 모델을 가져와 스스로 업데이트합니다.

### 2. 학습 서버

- **역할:** 새로운 AI 모델을 주기적으로 만들어내는 “AI 트레이너”입니다.
- **주요 임무:**
    1.  **주기적 학습:** 매주 가장 최신 한 달 치의 데이터를 사용해 새로운 모델을 학습합니다.
    2.  **결과 보고 및 등록:** 모든 학습 과정과 결과를 MLflow에 꼼꼼히 기록하고, 학습 완료된 모델을 날짜 기반 별칭으로 MLflow 레지스트리에 등록합니다.

### 3. MLflow 서버

- **역할:** 모든 모델 개발 프로젝트를 관리하고 지휘하는 “총괄 감독” 또는 “전략 분석실”입니다.
- **주요 임무:**
    1.  **실험 관리:** 모든 학습 시도(Experiment)를 기록하고 추적합니다.
    2.  **모델 레지스트리:** 학습된 모든 모델의 목록을 **날짜 기반 별칭(`20250531` 등)**으로 관리합니다. 추론 서버는 이 별칭을 기준으로 최신 모델을 찾아갑니다.
    3.  **결과 시각화:** 개발자가 웹 브라우저로 접속해 여러 모델의 성능을 한눈에 비교하고 분석할 수 있는 대시보드를 제공합니다.

### 4. MinIO 서버

- **역할:** 학습된 모델 파일, 데이터셋 등 모든 결과물을 안전하게 보관하는 “거대 창고”입니다.
- **주요 임무:**
    1.  **아티팩트 저장:** MLflow의 지시에 따라 학습이 완료된 AI 모델 파일(`.pkl`, `.pt` 등)과 각종 결과물을 저장합니다.
    2.  **파일 제공:** 다른 서버(주로 추론 서버나 학습 서버)가 특정 모델 파일을 요청하면 안전하게 전달해줍니다.

### 5. MySQL DB 서버

- **역할:** 정형화된 데이터를 기록하는 “꼼꼼한 장부”입니다.
- **주요 임무:**
    1.  **원본 데이터 저장:** 학습에 사용할 2년간의 비트코인 시세 데이터를 저장합니다.
    2.  **MLflow 백엔드:** MLflow가 기록하는 수많은 실험 데이터(파라미터, 성능 수치 등 텍스트 정보)를 저장하는 데이터베이스 역할을 합니다.
